<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AR Ã‡iftlik V3</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

    <style>
        /* 1. VR BUTONUNU ZORLA GÄ°ZLEME (CSS Ä°LE) */
        .a-enter-vr, .a-enter-vr-button, .a-orientation-modal {
            display: none !important; /* Kesinlikle gÃ¶sterme */
        }

        /* 2. BÄ°ZÄ°M AR BUTONUMUZUN TASARIMI */
        #baslat-butonu {
            position: fixed;
            bottom: 30px;         /* AÅŸaÄŸÄ±dan 30px yukarÄ±da */
            left: 50%;
            transform: translateX(-50%); /* Tam ortala */
            width: 200px;         /* GeniÅŸlik sabit */
            height: 50px;         /* YÃ¼kseklik sabit */
            background-color: #ff4081; /* CanlÄ± Pembe */
            color: white;
            border: 2px solid white;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            z-index: 99999;       /* Her ÅŸeyin en Ã¼stÃ¼nde */
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            cursor: pointer;
            display: flex;        /* YazÄ±yÄ± ortalamak iÃ§in */
            align-items: center;
            justify-content: center;
        }
    </style>

    <script>
        // AR YERLEÅžTÄ°RME MANTIÄžI
        AFRAME.registerComponent('ar-kontrol', {
            init: function () {
                this.reticle = document.querySelector("#hedef-halkasi");
                this.farm = document.querySelector("#ciftlik-modeli");
                this.placed = false;

                // Sahneye tÄ±klandÄ±ÄŸÄ±nda (Butona deÄŸil, ekrana)
                this.el.sceneEl.addEventListener('click', () => {
                    if (this.placed) return; // Zaten koyduysak tekrar koyma

                    // EÄŸer halka gÃ¶rÃ¼nÃ¼rse (zemin algÄ±landÄ±ysa)
                    if (this.reticle.object3D.visible) {
                        // Ã‡iftliÄŸi halkanÄ±n olduÄŸu yere Ä±ÅŸÄ±nla
                        this.farm.setAttribute('position', this.reticle.getAttribute('position'));
                        this.farm.setAttribute('rotation', this.reticle.getAttribute('rotation'));
                        
                        // Ã‡iftliÄŸi gÃ¶rÃ¼nÃ¼r yap
                        this.farm.setAttribute('visible', 'true');
                        
                        // HalkayÄ± kalÄ±cÄ± olarak gizle
                        this.reticle.setAttribute('visible', 'false');
                        this.placed = true;
                    }
                });
            }
        });

        // BUTONA BASINCA Ã‡ALIÅžACAK FONKSÄ°YON
        function kamerayiAc() {
            var scene = document.querySelector('a-scene');
            var btn = document.querySelector('#baslat-butonu');
            
            // WebXR AR oturumunu baÅŸlat
            scene.enterVR(); 
            
            // Butonu artÄ±k gizle
            btn.style.display = 'none';
        }
    </script>
</head>

<body style="margin: 0; overflow: hidden; background-color: transparent;">

    <div id="baslat-butonu" onclick="kamerayiAc()">
        KAMERAYI AÃ‡ ðŸ“·
    </div>

    <a-scene 
        ar-kontrol
        webxr="optionalFeatures: hit-test, dom-overlay; overlayElement: #baslat-butonu"
        vr-mode-ui="enabled: false"
        renderer="alpha: true; antialias: true;"
        background="color: transparent">

        <a-light type="directional" position="1 4 2" intensity="1.2"></a-light>
        <a-light type="ambient" intensity="0.6"></a-light>

        <a-entity id="hedef-halkasi" ar-hit-test-target visible="false">
            <a-ring color="white" rotation="-90 0 0" radius-inner="0.1" radius-outer="0.15" opacity="0.8"></a-ring>
            <a-circle color="white" rotation="-90 0 0" radius="0.05" opacity="0.5"></a-circle>
        </a-entity>

        <a-entity id="ciftlik-modeli" visible="false" position="0 0 -2">
            <a-box position="0 -0.1 0" width="2" height="0.1" depth="2" color="#4CAF50"></a-box>
            
            <a-box position="-0.5 0.5 0" color="#D32F2F" scale="0.8 1 0.8"></a-box>
            <a-cone position="-0.5 1.2 0" radius-bottom="0.6" height="0.5" color="#5D4037"></a-cone>
            
            <a-cylinder position="0.6 0.4 0.6" radius="0.1" height="0.8" color="#795548"></a-cylinder>
            <a-dodecahedron position="0.6 1 0.6" radius="0.4" color="#388E3C"></a-dodecahedron>
        </a-entity>

        <a-entity ar-hit-test="target:#hedef-halkasi; type:map"></a-entity>

    </a-scene>

</body>
</html>
